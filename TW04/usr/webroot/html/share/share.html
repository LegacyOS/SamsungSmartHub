<html>

<head>
<TAG_VARSTART_CHARSET>
<meta http-equiv="Content-Type" content="text/html; charset={TAG_charset}">
<TAG_VAREND_CHARSET>
<title>Edit Share</title>
<link rel="StyleSheet" type="text/css" href="/css/storlib.css">
</head>


<script language="JavaScript" type="text/javascript" src="/javascript/storlib.js"></script>
<script language="JavaScript" type="text/javascript">
<!-- Start Script
<TAG_VARSTART_ISFTP>             
var is_ftp = {TAG_isftp};
<TAG_VAREND_ISFTP>             

<TAG_VARSTART_ISNFS>             
var is_nfs = {TAG_isnfs};
<TAG_VAREND_ISNFS>             

var a_user_desc=new Array(
//@a_user_comments#
);

var a_user_mountPoint=new Array(
//@a_user_shares#
);

<TAG_LOOPSTART_JSARRAY>
	{TAG_jsarray}
<TAG_LOOPEND_JSARRAY>

function showShare()
{
	var index = document.form.share_select.selectedIndex;
	var len = 0;

	if ((index >= 0) && (index < document.form.share_select.options.length - 1))
	{
		document.form.name.value = document.form.share_select.options[index].text;
		document.form.path.value = document.form.name.value;
		document.form.name.disabled = true;
		document.form.description.value = (index < a_user_desc.length)? a_user_desc[index]: "";
	}
	else if (index == document.form.share_select.options.length - 1)
	{
		clearForm();
	}
	else
	{
		document.form.name.value = "";
		document.form.description.value = "";
	}
	document.form.share_select.focus();
}

function showPath()
{
	document.form.path.value = document.form.name.value;
}

function clearForm()
{
	document.form.share_select.selectedIndex = document.form.share_select.options.length - 1;
	document.form.name.value = "";
	document.form.path.value = "";
	document.form.description.value = "";
	document.form.name.disabled = false;
	return true;
}

function show_system_error_message()
{
<TAG_VARSTART_ERR_MSG>
	var message = "{TAG_err_msg}";
<TAG_VAREND_ERR_MSG>

	if (message != "")
	{
		alert(message);
	}
}

//End Script -->
</script>


<body onLoad="get_cookie();show_system_error_message()">
<form name="form" method="post" action="/cgi/share/shareHandler.cgi">

<table border="0" width="600" cellspacing="0" cellpadding="2">
<tr>
<TAG_VARSTART_SHAREMANAGEMENT>
	<td colspan="2" class="TITLE">{TAG_ft_shareManagement}</td>
<TAG_VAREND_SHAREMANAGEMENT>
</tr>
<tr>
<TAG_VARSTART_EXISTINGSHARE>
	<td class="HEAD" width="20%">{TAG_ft_existingShares}</td>
<TAG_VAREND_EXISTINGSHARE>
	<td class="CONTENT">
			<select size="6" name="share_select" onChange="showShare()">
<TAG_LOOPSTART_SHARE_SELECT>
			<option>{TAG_existShare}</option>
<TAG_LOOPEND_SHARE_SELECT>
			<option>===== END LIST =====</option>
			</select></td>
</tr>
<tr>
<TAG_VARSTART_IDINFO>
	<td class="HEAD">{TAG_ft_shareName}</td>
	<td class="CONTENT"><input type="text" name="name" size="20" onchange="showPath()"></td>
</tr>
<tr>
	<td class="HEAD">{TAG_ft_path}</td>
<TAG_VAREND_IDINFO>
	<td class="CONTENT">
<TAG_VARSTART_PATH>
		<input type="text" name="mountPoint" size="10" value="{TAG_path}" readonly>
<TAG_VAREND_PATH>
		/ <input type="text" name="path" size="20" readonly></td>
	</tr>
<tr>
<TAG_VARSTART_DESC>
	<td class="HEAD">{TAG_ft_desc}</td>
<TAG_VAREND_DESC>
	<td class="CONTENT"><input type="text" name="description" size="50" maxlength="64"></td></tr>

<tr>
	<td colspan="2">
		<p align="center">
<TAG_VARSTART_BUTTON>
<script language="javascript">
if (is_ftp)
	document.write("<input class=\"button\" type=\"button\" value=\"{TAG_bt_nonLinux}\" onClick=\"goto_nonLinux()\">&nbsp;");
else
	document.write("<input class=\"button\" type=\"button\" value=\"{TAG_bt_noftp}\" onClick=\"goto_nonLinux()\">&nbsp;");
if (is_nfs)
	document.write("<input class=\"button\" type=\"button\" value=\"{TAG_bt_nfs}\" onClick=\"goto_Linux()\">&nbsp;");
</script>
		<input class="button" type="button" value="{TAG_bt_save}" onClick="checkValue()">&nbsp;
		<input class="button" type="button" value="{TAG_bt_clearForm}" onClick="clearForm()">&nbsp; 
		<input class="button" type="button" name="delete" value="{TAG_bt_delShare}" onClick="delete_share()">
<TAG_VAREND_BUTTON>
		</td>
	</tr>
</table>
</form>
</body>


<script language="JavaScript" type="text/javascript">
<!-- Start Script
<TAG_VARSTART_JS>

var msg_blank = " {TAG_msg_blank}";

function checkValue()
{
	var msg = storlib_checkBlank(document.form.name, "{TAG_ft_shareName}", true, msg_blank);
	if (msg.length > 0)
	{
		alert(msg);
		return false;
	}

	var s1 = document.form.name.value.toLowerCase();
	document.form.name.value = s1 ;
	
	if (document.form.description.value != "")
	{
		msg = "{TAG_em_desc}";
		for (var i = 0; i < document.form.description.value.length; i++)
		{
			var ch = document.form.description.value.charAt(i);
			if(!isAlpha(ch) && !isNumeric(ch) && !isDesc(ch))
			{
				alert(msg);
				document.form.description.focus();
				return false;
			}
		}
	}

	document.form.name.disabled = false;
	document.form.submit();
}

function goto_nonLinux()
{
	document.form.name.disabled = false;

	var index = document.form.share_select.selectedIndex;
	var name = document.form.name;

	if (index < 0 || index >= (document.form.share_select.options.length - 1))
	{
		alert("{TAG_em_msg_no_share}");
		return false;
	}

	var para = "name=" + name.value;
	var target = "/cgi/share/share_nonLinux.cgi?" + para;
	gotoUrl(target);
}

function goto_Linux()
{
	document.form.name.disabled = false;

	var index = document.form.share_select.selectedIndex;
	var name = document.form.name;

	if (index < 0 || index >= (document.form.share_select.options.length - 1))
	{
		alert("{TAG_em_msg_no_share}");
		return false;
	}

	var para = "name=" + name.value;
	var target = "/cgi/share/share_Linux.cgi?" + para;
	gotoUrl(target);
}

function delete_share()
{
	document.form.name.disabled = false;

	var index = document.form.share_select.selectedIndex;
	var name = document.form.name;

	if (index < 0 || index >= (document.form.share_select.options.length - 1))
	{
		alert("{TAG_em_msg_no_share}");
		return false;
	}

	if (confirm("{TAG_jc_delConfirm}") == true)
	{
		var para = "name=" + name.value;
		para = para.replace(/ /g, "S");
		para = para.replace(/\+/g, "G");
		para = para.replace(/&/g, "A");
		var target = "/cgi/share/shareDeleteHandler.cgi?" + para;
		gotoUrl(target);
	}
}

<TAG_VAREND_JS>
//End Script -->
</script>
</html>
