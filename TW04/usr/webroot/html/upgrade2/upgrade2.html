<html>

<head>
<TAG_VARSTART_CHARSET>
<meta http-equiv="Content-Type" content="text/html; charset={TAG_charset}">
<TAG_VAREND_CHARSET>
<title>Firmware Upgrade</title>
<link rel="StyleSheet" type="text/css" href="/css/storlib.css">
</head>


<script language="JavaScript" type="text/javascript" src="/javascript/storlib.js"></script>
<script language="JavaScript" type="text/javascript">
<!-- Start Script
function show_system_error_message()
{
<TAG_VARSTART_ERR_MSG>
	var message = "{TAG_err_msg}";
<TAG_VAREND_ERR_MSG>

	if (message != "")
	{
		alert(message);
	}
}

function reload()
{
	location = location;
}

function refresh()
{
	setTimeout("reload()",15000);
	return true;

}

//-->
</script>

<body onLoad="get_cookie();show_system_error_message();">
<form name="form" ENCTYPE="multipart/form-data" method="post" action="/cgi/upgrade2/upgradeHandler.cgi">
<!--layerpopup Div-->
<TAG_VARSTART_WAIT>
<Div id="layerPop" style="position:absolute; left:50px; top:150px; width:300px; height:40px; z-index:0;display:none;">
<tr>
<lign="center" valign="middle">
<table bgcolor="#FFFFFF" bordercolor="00A5FF" cellpadding="10" cellspacing="1" border="1" width="400" height="30">
<tr>
<td align="center">
<font size="4" color="#0064CD">{TAG_ft_wait}</font><br><br>
<marquee direction="right" width="400" height="1" scrollamount="30">
<img src="/image/01_bar_on.png" width="100" height="5">
</marquee>
</table>
</td></tr>
</table>
</td></tr>
</table>
</center>
</Div>
<TAG_VAREND_WAIT>
<!-- //layerpopup div end-->

<script language="JavaScript" type="text/javascript">
<TAG_VARSTART_UPGRADE>
var upgrade_status = "{TAG_upgrade_status}";
var live_upgrade_status = "{TAG_live_upgrade_status}";

    document.write('<table border="0" width="550" cellspacing="0" cellpadding="2">');
	document.write('  <tr><td colspan=2 class="TITLE" >{TAG_ft_fwUpgrade}</td></tr>');
	document.write('  <tr><td  width="200" class="HEAD">{TAG_ft_currentVer}</td>');
	document.write('    <td class="CONETNT">{TAG_software_version}</td>');
	document.write('  </tr>');
	document.write('  <tr><td  width="200" class="HEAD">{TAG_ft_liveUpgradeStatus}</td>');
	if (live_upgrade_status == 3){
		document.write('    <td class="CONETNT"><font color=blue>{TAG_liveUpgradeStatus}</font></td>');
	}else{
		document.write('    <td class="CONETNT">{TAG_liveUpgradeStatus}</td>');
	}
	document.write('  </tr>');

	if (live_upgrade_status == 3){
		document.write('  <tr>');
		document.write('    <td colspan="2">');
		document.write('    <p align="center"><input class="button" type="button" value="{TAG_bt_start2}"  onClick="liveUpgrade()">');
		document.write('    </td>');
		document.write('  </tr>');
	}

	document.write('  <tr><td colspan=2>&nbsp;</td></tr>');
	document.write('  <tr><td  width="200" class="HEAD">{TAG_ft_manual_upgrade}</td>');
	document.write('    <td class="CONTENT"><input type="file" name="upfilename" value="" size="30" maxlength="255"></td>');
	document.write('  </tr>');

	document.write('  <tr>');
	document.write('    <td colspan="2">');
	document.write('    <p align="center"><input class="button" type="button" value="{TAG_bt_start}"  onClick="checkValue()">');
	document.write('    </td>');
	document.write('  </tr>');
	document.write('</table>');
if(upgrade_status == "START") {
    document.write('<br><br>');
    document.write('<table height="13" width="385" border="0"  cellpadding="0" cellspacing="0">');
    document.write('<tr><td colspan="4" class="TITLE1" nowrap><div align="left">{TAG_bt_process}</div></td></tr>');
	document.write('<br>');
    document.write('<tr>');
    document.write('    <td class="CONTENT1" width="85" nowrap><div align="left">{TAG_upgrade_percent}</div></td>');
    document.write('    <td width="{TAG_upgrade_finished}" bgcolor="#0000ff" ></td>');
    document.write('    <td width="1" bgcolor="000000" ></td>');
    document.write('    <td width="{TAG_upgrade_remainder}"  bgcolor="#CCCCCC" ></td>');
    document.write('</tr>');
    document.write('</table>');
    refresh();
} else if(upgrade_status == "END"){
    top.location="http://"+document.location.host+"/cgi/return/return.cgi?flag=5";
}

<TAG_VAREND_UPGRADE>
</script>

</form>

</body>


<script language="JavaScript" type="text/javascript">
<!-- Start Script
<TAG_VARSTART_JS>

var msg_blank = " {TAG_msg_blank}";

function ViewlayerPop(){
    document.getElementById("layerPop").style.display='inline'
}
function checkValue()
{
	var msg = storlib_checkBlank(document.form.upfilename, "{TAG_ft_file}", true, msg_blank);

	if(msg.length > 0)
	{
		if (live_upgrade_status != 3){
			alert(msg);
			return false;
		}
	}

	if (confirm("{TAG_cf_message}"))
	{
			ViewlayerPop();
			document.form.submit();
			return true;
	}
}

function liveUpgrade()
{
	document.form.upfilename.value="";

	if (confirm("{TAG_cf_message}"))
	{
			ViewlayerPop();
			document.form.submit();
			return true;
	}
}

<TAG_VAREND_JS>
//End Script -->
</script>
</html>
