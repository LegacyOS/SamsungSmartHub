<html>

<head>
<TAG_VARSTART_CHARSET>
<meta http-equiv="Content-Type" content="text/html; charset={TAG_charset}">
<TAG_VAREND_CHARSET>
<title>Network Setting</title>
<link rel="StyleSheet" type="text/css" href="/css/storlib.css">

</head>

<script language="JavaScript" type="text/javascript" src="/javascript/storlib.js"></script>
<script language="JavaScript" type="text/javascript">
<!-- Start Script


function changepage()
{
	location.replace("wan.cgi?temp_bootproto=pppoe");
}

function bootproto_select()
{
	<TAG_VARSTART_TEMP_BOOTPROTO>
	var temp_bootproto = "{TAG_temp_bootproto}";
	<TAG_VAREND_TEMP_BOOTPROTO>
	
	if( temp_bootproto == "pppoe" )
		alert(temp_bootproto);

	if(document.form.bootproto[0].selected == true)
	{
		document.form.ipaddr_1.disabled = false;
		document.form.ipaddr_2.disabled = false;
		document.form.ipaddr_3.disabled = false;
		document.form.ipaddr_4.disabled = false;
		document.form.netmask_1.disabled = false;
		document.form.netmask_2.disabled = false;
		document.form.netmask_3.disabled = false;
		document.form.netmask_4.disabled = false;
		document.form.gateway_1.disabled = false;
		document.form.gateway_2.disabled = false;
		document.form.gateway_3.disabled = false;
		document.form.gateway_4.disabled = false;
		//document.form.dnsStatic.checked = true;
		document.form.dnsStatic[0].disabled = true;
		document.form.dnsStatic[1].checked = true;
		document.form.reget_button.disabled = true;
		dns_select();
	}
	else if (document.form.bootproto[1].selected == true)
	{
		document.form.ipaddr_1.disabled = true;
		document.form.ipaddr_2.disabled = true;
		document.form.ipaddr_3.disabled = true;
		document.form.ipaddr_4.disabled = true;
		document.form.netmask_1.disabled = true;
		document.form.netmask_2.disabled = true;
		document.form.netmask_3.disabled = true;
		document.form.netmask_4.disabled = true;
		document.form.gateway_1.disabled = true;
		document.form.gateway_2.disabled = true;
		document.form.gateway_3.disabled = true;
		document.form.gateway_4.disabled = true;
		document.form.dnsStatic[0].disabled = false;
		document.form.reget_button.disabled = false;
	}
	
	else if (document.form.bootproto[2].selected == true)
	{
		changepage();
	}
	else if ( document.form.bootproto[3].selected == true)
	{
		document.form.ipaddr_1.disabled = true;
		document.form.ipaddr_2.disabled = true;
		document.form.ipaddr_3.disabled = true;
		document.form.ipaddr_4.disabled = true;
		document.form.netmask_1.disabled = true;
		document.form.netmask_2.disabled = true;
		document.form.netmask_3.disabled = true;
		document.form.netmask_4.disabled = true;
		document.form.gateway_1.disabled = true;
		document.form.gateway_2.disabled = true;
		document.form.gateway_3.disabled = true;
		document.form.gateway_4.disabled = true;
		document.form.dns_p_1.disabled = true;
		document.form.dns_p_2.disabled = true;
		document.form.dns_p_3.disabled = true;
		document.form.dns_p_4.disabled = true;
		document.form.dns_b1_1.disabled = true;
		document.form.dns_b1_2.disabled = true;
		document.form.dns_b1_3.disabled = true;
		document.form.dns_b1_4.disabled = true;
		document.form.dns_b2_1.disabled = true;
		document.form.dns_b2_2.disabled = true;
		document.form.dns_b2_3.disabled = true;
		document.form.dns_b2_4.disabled = true;
		document.form.dnsStatic[0].disabled = true;
		document.form.dnsStatic[1].checked = true;
		document.form.reget_button.disabled = true;
	}
}

function dns_select()
{
	if(document.form.dnsStatic[1].checked == true)
	{
		document.form.dns_p_1.disabled = false;
		document.form.dns_p_2.disabled = false;
		document.form.dns_p_3.disabled = false;
		document.form.dns_p_4.disabled = false;
		document.form.dns_b1_1.disabled = false;
		document.form.dns_b1_2.disabled = false;
		document.form.dns_b1_3.disabled = false;
		document.form.dns_b1_4.disabled = false;
		document.form.dns_b2_1.disabled = false;
		document.form.dns_b2_2.disabled = false;
		document.form.dns_b2_3.disabled = false;
		document.form.dns_b2_4.disabled = false;
	}
	else
	{
		document.form.dns_p_1.disabled = true;
		document.form.dns_p_2.disabled = true;
		document.form.dns_p_3.disabled = true;
		document.form.dns_p_4.disabled = true;
		document.form.dns_b1_1.disabled = true;
		document.form.dns_b1_2.disabled = true;
		document.form.dns_b1_3.disabled = true;
		document.form.dns_b1_4.disabled = true;
		document.form.dns_b2_1.disabled = true;
		document.form.dns_b2_2.disabled = true;
		document.form.dns_b2_3.disabled = true;
		document.form.dns_b2_4.disabled = true;
	}
}

<TAG_VARSTART_TZERO>
var have_tzero = {TAG_have_tzero};
<TAG_VAREND_TZERO>

function show_system_error_message()
{
<TAG_VARSTART_ERR_MSG>
	var message = "{TAG_err_msg}";
<TAG_VAREND_ERR_MSG>

	if (message != "")
	{
		alert(message);
	}
}

//End Script -->
</script>


<body onLoad="get_cookie();bootproto_select();dns_select();show_system_error_message()">
<FORM name="form" method="post" action="/cgi/wan/wanHandler.cgi">
<!--layerpopup Div-->
<TAG_VARSTART_WAIT>
<Div id="layerPop" style="position:absolute; left:30px; top:350px; width:300px; height:40px; z-index:0;display:none;">
<tr>
<lign="center" valign="middle">
<table bgcolor="#FFFFFF" bordercolor="00A5FF" cellpadding="10" cellspacing="1" border="1" width="400" height="30">
<tr>
<td align="center">
<font size="4" color="#0064CD">{TAG_ft_wait}</font><br><br>
<marquee direction="right" width="400" height="1" scrollamount="30">
<img src="/image/01_bar_on.png" width="100" height="5">
</marquee>
</table>
</td></tr>
</table>
</td></tr>
</table>
</center>
</Div>
<TAG_VAREND_WAIT>
<!-- //layerpopup div end-->

<table border="0" width="550" cellspacing="0" cellpadding="2">
    <tr>
<TAG_VARSTART_SETTING>
	<td colspan="2" class="TITLE">{TAG_ft_setting}</td>
<TAG_VAREND_SETTING>
    </tr>
    <tr>
<TAG_VARSTART_IPMODE>
	<td class="HEAD">{TAG_ft_ipMode}</td>
<TAG_VAREND_IPMODE>
<TAG_VARSTART_BOOTPROTO>
<script language="javascript">
	with(document)
	{
		write("<td width=\"320\" >");
		write("<SELECT name=\"bootproto\" onChange=\"bootproto_select()\">");
		write("<OPTION {TAG_Static_checked} value=\"static\">{TAG_ft_Static}</OPTION>");
		write("<OPTION {TAG_DHCP_checked} value=\"dhcp\">{TAG_ft_DHCP}</OPTION>");
		if (!have_tzero)
			write("<OPTION {TAG_PPPoE_checked} value=\"pppoe\">{TAG_ft_PPPoE}</OPTION>");
		write("<OPTION {TAG_none_checked} value=\"none\">{TAG_ft_none}</OPTION>");
	    write("</SELECT>");
	}
</script>
<TAG_VAREND_BOOTPROTO>
<TAG_VARSTART_RESET_DHCP>
		<input class="button" name="reget_button" type="button" value="{TAG_ft_reset_dhcp}" onClick="regetIP()">
<TAG_VAREND_RESET_DHCP>
	</td>

    </tr>
    <tr>
<TAG_VARSTART_IPMASQUERADE>
	<td class="HEAD">{TAG_ft_masquerading}</td>
<TAG_VAREND_IPMASQUERADE>
<TAG_VARSTART_MASQUERADE_TYPE>
<script language="javascript">
	with(document)
	{
		write("<td>");
		write("<SELECT name=\"masq_type\" onChange=\"\">");
		if (have_tzero)
			write("<OPTION {TAG_ipforward_checked} value=\"2\">IP Forwarding</OPTION>");
		else
			write("<OPTION {TAG_forward_and_masq_checked} value=\"1\">{TAG_ft_forward_and_masquerade}</OPTION>");
		write("<OPTION {TAG_not_forward_checked} value=\"0\">{TAG_ft_not_forward}</OPTION>");
	    write("</SELECT>");
		write("</td>");
	}
</script>
<TAG_VAREND_MASQUERADE_TYPE>
    </tr>
    <tr>
<TAG_VARSTART_IPADDRESS>
	<td class="HEAD">{TAG_ft_ip}</td>
	<td>&nbsp;
	    <input type="text" name="ipaddr_1" size="3" maxlength="3" value="{TAG_ip_1}">.
	    <input type="text" name="ipaddr_2" size="3" maxlength="3" value="{TAG_ip_2}">.
	    <input type="text" name="ipaddr_3" size="3" maxlength="3" value="{TAG_ip_3}">.
	    <input type="text" name="ipaddr_4" size="3" maxlength="3" value="{TAG_ip_4}">
<TAG_VAREND_IPADDRESS>
	</td>
    </tr>
    <tr>
<TAG_VARSTART_NETMASK>
	<td class="HEAD">{TAG_ft_subnetMask}</td>
	<td>&nbsp;
	    <input type="text" name="netmask_1" size="3" maxlength="3" value="{TAG_mask_1}">.
	    <input type="text" name="netmask_2" size="3" maxlength="3" value="{TAG_mask_2}">.
	    <input type="text" name="netmask_3" size="3" maxlength="3" value="{TAG_mask_3}">.
	    <input type="text" name="netmask_4" size="3" maxlength="3" value="{TAG_mask_4}">
<TAG_VAREND_NETMASK>
	</td>
    </tr>
    <tr>
<TAG_VARSTART_GATEWAY>
	<td class="HEAD">{TAG_ft_gateway}</td>
	<td>&nbsp;
	    <input type="text" name="gateway_1" size="3" maxlength="3" value="{TAG_way_1}">.
	    <input type="text" name="gateway_2" size="3" maxlength="3" value="{TAG_way_2}">.
	    <input type="text" name="gateway_3" size="3" maxlength="3" value="{TAG_way_3}">.
	    <input type="text" name="gateway_4" size="3" maxlength="3" value="{TAG_way_4}">
<TAG_VAREND_GATEWAY>
	</td>
    </tr>
<TAG_VARSTART_DNSSTATIC>
    <tr>
	<td class="CONTENT" colspan="2"><input type="radio" name="dnsStatic" value="0" {TAG_dhcp_dns}  onClick="dns_select()">
	&nbsp;{TAG_ft_dhcp_dns}</td>
    </tr>
    <tr>
	<td class="CONTENT" colspan="2"><input type="radio" name="dnsStatic" value="1" {TAG_fix_dns} onClick="dns_select()" >
	&nbsp;{TAG_ft_fix_dns}</td>
    </tr>
<TAG_VAREND_DNSSTATIC>	  
    <tr>
<TAG_VARSTART_DNS1>
	<td class="HEAD">{TAG_ft_1st}</td>
	<td>&nbsp;
	    <input type="text" name="dns_p_1" size="3" maxlength="3" value="{TAG_dns1_1}" >.
	    <input type="text" name="dns_p_2" size="3" maxlength="3" value="{TAG_dns1_2}" >.
	    <input type="text" name="dns_p_3" size="3" maxlength="3" value="{TAG_dns1_3}" >.
	    <input type="text" name="dns_p_4" size="3" maxlength="3" value="{TAG_dns1_4}" >
<TAG_VAREND_DNS1>
	</td>
    </tr>
    <tr>
<TAG_VARSTART_DNS2>
	<td class="HEAD">{TAG_ft_2nd}</td>
	<td>&nbsp;
	    <input type="text" name="dns_b1_1" size="3" maxlength="3" value="{TAG_dns2_1}" >.
	    <input type="text" name="dns_b1_2" size="3" maxlength="3" value="{TAG_dns2_2}" >.
	    <input type="text" name="dns_b1_3" size="3" maxlength="3" value="{TAG_dns2_3}" >.
	    <input type="text" name="dns_b1_4" size="3" maxlength="3" value="{TAG_dns2_4}" >
<TAG_VAREND_DNS2>
	    </td>
    </tr>
    <tr>
<TAG_VARSTART_DNS3>
	<td class="HEAD">{TAG_ft_3rd}</td>
	<td>&nbsp;
	    <input type="text" name="dns_b2_1" size="3" maxlength="3" value="{TAG_dns3_1}" >.
	    <input type="text" name="dns_b2_2" size="3" maxlength="3" value="{TAG_dns3_2}" >.
	    <input type="text" name="dns_b2_3" size="3" maxlength="3" value="{TAG_dns3_3}" >.
	    <input type="text" name="dns_b2_4" size="3" maxlength="3" value="{TAG_dns3_4}" >
<TAG_VAREND_DNS3>
	</td>
    </tr>
    <tr>
	<td colspan="2" width="320">
<TAG_VARSTART_BUTTON>
	    <p align="center"><input class="button" type="button" name="save" value="{TAG_bt_save}" style="width: 60px" onClick="checkValue()">
	</td>
<TAG_VAREND_BUTTON>
    </tr>
</table> 
<TAG_VARSTART_OLDIPADDR>
	<input type="hidden" name="oldipaddr" value="{TAG_oldipaddr}">
<TAG_VAREND_OLDIPADDR>
	<input type="hidden" name="reget_mode" value="none">
</form>
</body>


<script language="JavaScript" type="text/javascript">
<!-- Start Script
<TAG_VARSTART_JS>

var msg_blank = " {TAG_msg_blank}";
var msg_check_invalid = " {TAG_msg_check_invalid}";
var msg_greater = " {TAG_msg_greater} ";
var msg_less = " {TAG_msg_less} ";

function regetIP()
{
	document.form.reget_mode.value='dhcp';
	document.form.submit();
}

function ViewlayerPop(){
    document.getElementById("layerPop").style.display='inline'
}

function checkValue()
{
	var msg = "";
	var f = document.form;
	var mask = new Array();
	var ipaddr = new Array();
	var gateway = new Array();
	var isTrueMask = false;
	var isTheSameRange = false;

	for (i = 0; i < 4; i++) {
		mask[i] = eval('f.netmask_'+(i+1)+'.value');
		ipaddr[i] = eval('f.ipaddr_'+(i+1)+'.value');
		gateway[i] = eval('f.gateway_'+(i+1)+'.value');
	}

	if (document.form.bootproto[0].selected == true)
	{
		msg = storlib_checkIpValue(document.form.ipaddr_1, document.form.ipaddr_2, document.form.ipaddr_3, document.form.ipaddr_4, 0, 255, 0, 255, 0, 255, 0, 255, true, "{TAG_em_ip}", msg_blank, msg_check_invalid, msg_greater, msg_less)
		if (msg.length > 0)
		{
			alert(msg);
			return false;
		}

		msg = storlib_checkIpValue(document.form.netmask_1, document.form.netmask_2, document.form.netmask_3, document.form.netmask_4, 0, 255, 0, 255, 0, 255, 0, 255, true, "{TAG_em_subnetMask}", msg_blank, msg_check_invalid, msg_greater, msg_less)
		if (msg.length > 0)
		{
			alert(msg);
			return false;
		}

		isTrueMask = isSubnetMask(mask);
		
		if (!isTrueMask)
		{
			msg = "{TAG_em_subnetMask}";
			alert(msg);
			return false;
		}

		msg = storlib_checkIpValue(document.form.gateway_1, document.form.gateway_2, document.form.gateway_3, document.form.gateway_4, 0, 255, 0, 255, 0, 255, 0, 255, false, "{TAG_em_gateway}", msg_blank, msg_check_invalid, msg_greater, msg_less)
		if (msg.length > 0)
		{
			alert(msg);
			return false;
		}
		
		//isTheSameRange = isTheSameIpRange(ipaddr, mask, gateway);
		
		//if (!isTheSameRange)
		//{
		//	msg = "{TAG_em_gateway}";
		//	alert(msg);
		//	return false;
		//}
	}

	if (document.form.dnsStatic[1].checked == true)
	{
		msg = storlib_checkIpValue(document.form.dns_p_1, document.form.dns_p_2, document.form.dns_p_3, document.form.dns_p_4, 0, 255, 0, 255, 0, 255, 0, 255, false, "{TAG_em_1st}", msg_blank, msg_check_invalid, msg_greater, msg_less)
		if(msg.length > 0) {
			alert(msg);
			return false;
		}
		msg = storlib_checkIpValue(document.form.dns_b1_1, document.form.dns_b1_2, document.form.dns_b1_3, document.form.dns_b1_4, 0, 255, 0, 255, 0, 255, 0, 255, false, "{TAG_em_2nd}", msg_blank, msg_check_invalid, msg_greater, msg_less)
		if(msg.length > 0) {
			alert(msg);
			return false;
		}
		msg = storlib_checkIpValue(document.form.dns_b2_1, document.form.dns_b2_2, document.form.dns_b2_3, document.form.dns_b2_4, 0, 255, 0, 255, 0, 255, 0, 255, false, "{TAG_em_3rd}", msg_blank, msg_check_invalid, msg_greater, msg_less)
		if(msg.length > 0) {
			alert(msg);
			return false;
		}
	}

	if (confirm("{TAG_cf_message}"))
	{
		ViewlayerPop();
		document.form.submit();
		return true;
	}
}

<TAG_VAREND_JS>
//End Script -->
</script>
</html>
